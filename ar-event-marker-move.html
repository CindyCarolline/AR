<!doctype HTML>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <!-- Correcting zooming issue -->
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <!-- Library untuk VR membangun 3D -->
    <script src="./js/aframe/aframe.min.js"></script>
    <!-- Library untuk AR yang melakukan pengenalan marker dan menyematkan kamera-->
    <script src="./js/arjs/aframe-ar.js"></script>
    <title>WebAR: Marker Move Object</title>
</head>

<body style="margin : 0px; overflow: hidden;">
    <a-scene embedded vr-mode-ui="enabled: false" arjs="detectionMode: mono_and_matrix; matrixCodeType: 3x3; debugUIEnabled: false;">

        <!-- add a simple camera -->
        <a-entity camera></a-entity>

        <!-- handle hiro marker -->
        <a-marker preset="hiro">
            <a-sphere position="0 0 0" color="red" material="opacity: 0.5; color: blue;" radius="0.5"></a-sphere>
        </a-marker>

        <a-box position="0 0 0" color="red" material="opacity: 0.5; color: red;"></a-box>

    </a-scene>
    <script>
        // a-marker
        let m = document.querySelector("a-marker");

        // a-box
        let box = document.querySelector("a-box");

        function updateTransformation(obj3d, ent) {
            console.log(obj3d.position);
            console.log(obj3d.quaternion);
            ent.object3D.setRotationFromQuaternion(obj3d.quaternion);
            ent.object3D.position.set(obj3d.position.x, obj3d.position.y, obj3d.position.z);
        }

        m.addEventListener("markerFound", (e) => {
            // should be using tick in registercomponent
            setTimeout(updateTransformation(m.object3D, box), 2);
        });

        m.addEventListener("markerLost", (e) => {
            setTimeout(updateTransformation(m.object3D, box), 2);
        });
    </script>
</body>

</html>